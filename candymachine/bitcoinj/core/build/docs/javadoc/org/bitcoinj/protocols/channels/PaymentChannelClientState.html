<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.2) on Mon Mar 25 15:23:01 PDT 2019 -->
<title>PaymentChannelClientState (bitcoinj-core 0.16-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2019-03-25">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PaymentChannelClientState (bitcoinj-core 0.16-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":10,"i10":6,"i11":6,"i12":10,"i13":10,"i14":6,"i15":10,"i16":10,"i17":6,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.bitcoinj.protocols.channels</a></div>
<h2 title="Class PaymentChannelClientState" class="title">Class PaymentChannelClientState</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.bitcoinj.protocols.channels.PaymentChannelClientState</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="PaymentChannelV1ClientState.html" title="class in org.bitcoinj.protocols.channels">PaymentChannelV1ClientState</a></code>, <code><a href="PaymentChannelV2ClientState.html" title="class in org.bitcoinj.protocols.channels">PaymentChannelV2ClientState</a></code></dd>
</dl>
<hr>
<pre>public abstract class <span class="typeNameLabel">PaymentChannelClientState</span>
extends java.lang.Object</pre>
<div class="block"><p>A payment channel is a method of sending money to someone such that the amount of money you send can be adjusted
 after the fact, in an efficient manner that does not require broadcasting to the network. This can be used to
 implement micropayments or other payment schemes in which immediate settlement is not required, but zero trust
 negotiation is. Note that this class only allows the amount of money sent to be incremented, not decremented.</p>

 <p>This class has two subclasses, <a href="PaymentChannelV1ClientState.html" title="class in org.bitcoinj.protocols.channels"><code>PaymentChannelV1ClientState</code></a> and <a href="PaymentChannelV2ClientState.html" title="class in org.bitcoinj.protocols.channels"><code>PaymentChannelV2ClientState</code></a> for
 protocols version 1 and 2.</p>

 <p>This class implements the core state machine for the client side of the protocol. The server side is implemented
 by <a href="PaymentChannelServerState.html" title="class in org.bitcoinj.protocols.channels"><code>PaymentChannelServerState</code></a> and <a href="PaymentChannelClientConnection.html" title="class in org.bitcoinj.protocols.channels"><code>PaymentChannelClientConnection</code></a> implements a network protocol
 suitable for TCP/IP connections which moves this class through each state. We say that the party who is sending funds
 is the <i>client</i> or <i>initiating party</i>. The party that is receiving the funds is the <i>server</i> or
 <i>receiving party</i>. Although the underlying Bitcoin protocol is capable of more complex relationships than that,
 this class implements only the simplest case.</p>

 <p>A channel has an expiry parameter. If the server halts after the multi-signature contract which locks
 up the given value is broadcast you could get stuck in a state where you've lost all the money put into the
 contract. To avoid this, a refund transaction is agreed ahead of time but it may only be used/broadcast after
 the expiry time. This is specified in terms of block timestamps and once the timestamp of the chain chain approaches
 the given time (within a few hours), the channel must be closed or else the client will broadcast the refund
 transaction and take back all the money once the expiry time is reached.</p>

 <p>To begin, the client calls <a href="#initiate(org.bouncycastle.crypto.params.KeyParameter,org.bitcoinj.protocols.channels.IPaymentChannelClient.ClientChannelProperties)"><code>initiate(KeyParameter, IPaymentChannelClient.ClientChannelProperties)</code></a>, which moves the channel into state
 INITIATED and creates the initial multi-sig contract and refund transaction. If the wallet has insufficient funds an
 exception will be thrown at this point. Once this is done, call
 <a href="PaymentChannelV1ClientState.html#getIncompleteRefundTransaction()"><code>PaymentChannelV1ClientState.getIncompleteRefundTransaction()</code></a> and pass the resultant transaction through to the
 server. Once you have retrieved the signature, use <a href="PaymentChannelV1ClientState.html#provideRefundSignature(byte%5B%5D,org.bouncycastle.crypto.params.KeyParameter)"><code>PaymentChannelV1ClientState.provideRefundSignature(byte[], KeyParameter)</code></a>.
 You must then call <a href="#storeChannelInWallet(org.bitcoinj.core.Sha256Hash)"><code>storeChannelInWallet(Sha256Hash)</code></a> to store the refund transaction
 in the wallet, protecting you against a malicious server attempting to destroy all your coins. At this point, you can
 provide the server with the multi-sig contract (via <a href="#getContract()"><code>getContract()</code></a>) safely.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="PaymentChannelClientState.IncrementedPayment.html" title="class in org.bitcoinj.protocols.channels">PaymentChannelClientState.IncrementedPayment</a></span></code></th>
<td class="colLast">
<div class="block">Container for a signature and an amount that was sent.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a></span></code></th>
<td class="colLast">
<div class="block">The different logical states the channel can be in.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="StateMachine.html" title="class in org.bitcoinj.protocols.channels">StateMachine</a>&lt;<a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stateMachine">stateMachine</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected org.bitcoinj.protocols.channels.StoredClientChannel</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#storedChannel">storedChannel</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#valueToMe">valueToMe</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.bitcoinj.wallet.Wallet,org.bitcoinj.core.ECKey,org.bitcoinj.core.ECKey,org.bitcoinj.core.Coin,long)">PaymentChannelClientState</a></span>&#8203;(<a href="../../wallet/Wallet.html" title="class in org.bitcoinj.wallet">Wallet</a>&nbsp;wallet,
                         <a href="../../core/ECKey.html" title="class in org.bitcoinj.core">ECKey</a>&nbsp;myKey,
                         <a href="../../core/ECKey.html" title="class in org.bitcoinj.core">ECKey</a>&nbsp;serverKey,
                         <a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;value,
                         long&nbsp;expiryTimeInSeconds)</code></th>
<td class="colLast">
<div class="block">Creates a state object for a payment channel client.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#checkNotExpired()">checkNotExpired</a></span>()</code></th>
<td class="colLast">
<div class="block">Checks if the channel is expired, setting state to <a href="PaymentChannelClientState.State.html#EXPIRED"><code>PaymentChannelClientState.State.EXPIRED</code></a>, removing this channel from wallet
 storage and throwing an <code>IllegalStateException</code> if it is.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#disconnectFromChannel()">disconnectFromChannel</a></span>()</code></th>
<td class="colLast">
<div class="block">Sets this channel's state in <a href="StoredPaymentChannelClientStates.html" title="class in org.bitcoinj.protocols.channels"><code>StoredPaymentChannelClientStates</code></a> to unopened so this channel can be reopened
 later.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>abstract <a href="../../core/Transaction.html" title="class in org.bitcoinj.core">Transaction</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getContract()">getContract</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the contract which was used to initialize this channel</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected abstract <a href="../../core/Transaction.html" title="class in org.bitcoinj.core">Transaction</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getContractInternal()">getContractInternal</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the contract without changing the state machine</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>protected abstract <a href="../../script/Script.html" title="class in org.bitcoinj.script">Script</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getContractScript()">getContractScript</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected abstract long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getExpiryTime()">getExpiryTime</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>abstract int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMajorVersion()">getMajorVersion</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>abstract <a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRefundTxFees()">getRefundTxFees</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the fees that will be paid if the refund transaction has to be claimed because the server failed to settle
 the channel properly.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>protected abstract <a href="../../script/Script.html" title="class in org.bitcoinj.script">Script</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSignedScript()">getSignedScript</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the script that is signed.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getState()">getState</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>protected abstract com.google.common.collect.Multimap&lt;<a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a>,&#8203;<a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getStateTransitions()">getStateTransitions</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>abstract <a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTotalValue()">getTotalValue</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the total value of this channel (ie the maximum payment possible)</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getValueRefunded()">getValueRefunded</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the current amount refunded to us from the multisig contract (ie totalValue-valueSentToServer)</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getValueSpent()">getValueSpent</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the amount of money sent on this channel so far.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>protected abstract <a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getValueToMe()">getValueToMe</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="PaymentChannelClientState.IncrementedPayment.html" title="class in org.bitcoinj.protocols.channels">PaymentChannelClientState.IncrementedPayment</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#incrementPaymentBy(org.bitcoinj.core.Coin,org.bouncycastle.crypto.params.KeyParameter)">incrementPaymentBy</a></span>&#8203;(<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;size,
                  org.bouncycastle.crypto.params.KeyParameter&nbsp;userKey)</code></th>
<td class="colLast">
<div class="block">Updates the outputs on the payment contract transaction and re-signs it.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initiate()">initiate</a></span>()</code></th>
<td class="colLast">
<div class="block">Creates the initial multisig contract and incomplete refund transaction which can be requested at the appropriate
 time using <a href="PaymentChannelV1ClientState.html#getIncompleteRefundTransaction()"><code>PaymentChannelV1ClientState.getIncompleteRefundTransaction()</code></a> and
 <a href="PaymentChannelV1ClientState.html#getContract()"><code>PaymentChannelV1ClientState.getContract()</code></a>.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initiate(org.bouncycastle.crypto.params.KeyParameter,org.bitcoinj.protocols.channels.IPaymentChannelClient.ClientChannelProperties)">initiate</a></span>&#8203;(org.bouncycastle.crypto.params.KeyParameter&nbsp;userKey,
        <a href="IPaymentChannelClient.ClientChannelProperties.html" title="interface in org.bitcoinj.protocols.channels">IPaymentChannelClient.ClientChannelProperties</a>&nbsp;clientChannelProperties)</code></th>
<td class="colLast">
<div class="block">Creates the initial multisig contract and incomplete refund transaction which can be requested at the appropriate
 time using <a href="PaymentChannelV1ClientState.html#getIncompleteRefundTransaction()"><code>PaymentChannelV1ClientState.getIncompleteRefundTransaction()</code></a> and
 <a href="#getContract()"><code>getContract()</code></a>.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initWalletListeners()">initWalletListeners</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isSettlementTransaction(org.bitcoinj.core.Transaction)">isSettlementTransaction</a></span>&#8203;(<a href="../../core/Transaction.html" title="class in org.bitcoinj.core">Transaction</a>&nbsp;tx)</code></th>
<td class="colLast">
<div class="block">Returns true if the tx is a valid settlement transaction.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#storeChannelInWallet(org.bitcoinj.core.Sha256Hash)">storeChannelInWallet</a></span>&#8203;(<a href="../../core/Sha256Hash.html" title="class in org.bitcoinj.core">Sha256Hash</a>&nbsp;id)</code></th>
<td class="colLast">
<div class="block">Stores this channel's state in the wallet as a part of a <a href="StoredPaymentChannelClientStates.html" title="class in org.bitcoinj.protocols.channels"><code>StoredPaymentChannelClientStates</code></a> wallet
 extension and keeps it up-to-date each time payment is incremented.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateChannelInWallet()">updateChannelInWallet</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#watchCloseConfirmations()">watchCloseConfirmations</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="valueToMe">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>valueToMe</h4>
<pre>protected&nbsp;<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a> valueToMe</pre>
</li>
</ul>
<a id="stateMachine">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stateMachine</h4>
<pre>protected final&nbsp;<a href="StateMachine.html" title="class in org.bitcoinj.protocols.channels">StateMachine</a>&lt;<a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a>&gt; stateMachine</pre>
</li>
</ul>
<a id="storedChannel">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>storedChannel</h4>
<pre>protected&nbsp;org.bitcoinj.protocols.channels.StoredClientChannel storedChannel</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(org.bitcoinj.wallet.Wallet,org.bitcoinj.core.ECKey,org.bitcoinj.core.ECKey,org.bitcoinj.core.Coin,long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PaymentChannelClientState</h4>
<pre>public&nbsp;PaymentChannelClientState&#8203;(<a href="../../wallet/Wallet.html" title="class in org.bitcoinj.wallet">Wallet</a>&nbsp;wallet,
                                 <a href="../../core/ECKey.html" title="class in org.bitcoinj.core">ECKey</a>&nbsp;myKey,
                                 <a href="../../core/ECKey.html" title="class in org.bitcoinj.core">ECKey</a>&nbsp;serverKey,
                                 <a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;value,
                                 long&nbsp;expiryTimeInSeconds)
                          throws <a href="../../core/VerificationException.html" title="class in org.bitcoinj.core">VerificationException</a></pre>
<div class="block">Creates a state object for a payment channel client. It is expected that you be ready to
 <a href="#initiate(org.bouncycastle.crypto.params.KeyParameter,org.bitcoinj.protocols.channels.IPaymentChannelClient.ClientChannelProperties)"><code>initiate(KeyParameter, IPaymentChannelClient.ClientChannelProperties)</code></a> after construction (to avoid creating objects for channels which are
 not going to finish opening) and thus some parameters provided here are only used in
 <a href="#initiate(org.bouncycastle.crypto.params.KeyParameter,org.bitcoinj.protocols.channels.IPaymentChannelClient.ClientChannelProperties)"><code>initiate(KeyParameter, IPaymentChannelClient.ClientChannelProperties)</code></a> to create the Multisig contract and refund transaction.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>wallet</code> - a wallet that contains at least the specified amount of value.</dd>
<dd><code>myKey</code> - a freshly generated private key for this channel.</dd>
<dd><code>serverKey</code> - a public key retrieved from the server used for the initial multisig contract</dd>
<dd><code>value</code> - how many satoshis to put into this contract. If the channel reaches this limit, it must be closed.</dd>
<dd><code>expiryTimeInSeconds</code> - At what point (UNIX timestamp +/- a few hours) the channel will expire</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../core/VerificationException.html" title="class in org.bitcoinj.core">VerificationException</a></code> - If either myKey's pubkey or serverKey's pubkey are non-canonical (ie invalid)</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="isSettlementTransaction(org.bitcoinj.core.Transaction)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isSettlementTransaction</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;isSettlementTransaction&#8203;(<a href="../../core/Transaction.html" title="class in org.bitcoinj.core">Transaction</a>&nbsp;tx)</pre>
<div class="block">Returns true if the tx is a valid settlement transaction.</div>
</li>
</ul>
<a id="initWalletListeners()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initWalletListeners</h4>
<pre class="methodSignature">protected&nbsp;void&nbsp;initWalletListeners()</pre>
</li>
</ul>
<a id="watchCloseConfirmations()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>watchCloseConfirmations</h4>
<pre class="methodSignature">protected&nbsp;void&nbsp;watchCloseConfirmations()</pre>
</li>
</ul>
<a id="getState()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getState</h4>
<pre class="methodSignature">public&nbsp;<a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a>&nbsp;getState()</pre>
</li>
</ul>
<a id="getStateTransitions()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStateTransitions</h4>
<pre class="methodSignature">protected abstract&nbsp;com.google.common.collect.Multimap&lt;<a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a>,&#8203;<a href="PaymentChannelClientState.State.html" title="enum in org.bitcoinj.protocols.channels">PaymentChannelClientState.State</a>&gt;&nbsp;getStateTransitions()</pre>
</li>
</ul>
<a id="getMajorVersion()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMajorVersion</h4>
<pre class="methodSignature">public abstract&nbsp;int&nbsp;getMajorVersion()</pre>
</li>
</ul>
<a id="initiate()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initiate</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;initiate()
              throws <a href="ValueOutOfRangeException.html" title="class in org.bitcoinj.protocols.channels">ValueOutOfRangeException</a>,
                     <a href="../../core/InsufficientMoneyException.html" title="class in org.bitcoinj.core">InsufficientMoneyException</a></pre>
<div class="block">Creates the initial multisig contract and incomplete refund transaction which can be requested at the appropriate
 time using <a href="PaymentChannelV1ClientState.html#getIncompleteRefundTransaction()"><code>PaymentChannelV1ClientState.getIncompleteRefundTransaction()</code></a> and
 <a href="PaymentChannelV1ClientState.html#getContract()"><code>PaymentChannelV1ClientState.getContract()</code></a>. The way the contract is crafted can be adjusted by
 By default unconfirmed coins are allowed to be used, as for micropayments the risk should be relatively low.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="ValueOutOfRangeException.html" title="class in org.bitcoinj.protocols.channels">ValueOutOfRangeException</a></code> - if the value being used is too small to be accepted by the network</dd>
<dd><code><a href="../../core/InsufficientMoneyException.html" title="class in org.bitcoinj.core">InsufficientMoneyException</a></code> - if the wallet doesn't contain enough balance to initiate</dd>
</dl>
</li>
</ul>
<a id="initiate(org.bouncycastle.crypto.params.KeyParameter,org.bitcoinj.protocols.channels.IPaymentChannelClient.ClientChannelProperties)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initiate</h4>
<pre class="methodSignature">public abstract&nbsp;void&nbsp;initiate&#8203;(@Nullable
                              org.bouncycastle.crypto.params.KeyParameter&nbsp;userKey,
                              <a href="IPaymentChannelClient.ClientChannelProperties.html" title="interface in org.bitcoinj.protocols.channels">IPaymentChannelClient.ClientChannelProperties</a>&nbsp;clientChannelProperties)
                       throws <a href="ValueOutOfRangeException.html" title="class in org.bitcoinj.protocols.channels">ValueOutOfRangeException</a>,
                              <a href="../../core/InsufficientMoneyException.html" title="class in org.bitcoinj.core">InsufficientMoneyException</a></pre>
<div class="block">Creates the initial multisig contract and incomplete refund transaction which can be requested at the appropriate
 time using <a href="PaymentChannelV1ClientState.html#getIncompleteRefundTransaction()"><code>PaymentChannelV1ClientState.getIncompleteRefundTransaction()</code></a> and
 <a href="#getContract()"><code>getContract()</code></a>.
 By default unconfirmed coins are allowed to be used, as for micropayments the risk should be relatively low.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userKey</code> - Key derived from a user password, needed for any signing when the wallet is encrypted.
                The wallet KeyCrypter is assumed.</dd>
<dd><code>clientChannelProperties</code> - Modify the channel's configuration.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="ValueOutOfRangeException.html" title="class in org.bitcoinj.protocols.channels">ValueOutOfRangeException</a></code> - if the value being used is too small to be accepted by the network</dd>
<dd><code><a href="../../core/InsufficientMoneyException.html" title="class in org.bitcoinj.core">InsufficientMoneyException</a></code> - if the wallet doesn't contain enough balance to initiate</dd>
</dl>
</li>
</ul>
<a id="getContract()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContract</h4>
<pre class="methodSignature">public abstract&nbsp;<a href="../../core/Transaction.html" title="class in org.bitcoinj.core">Transaction</a>&nbsp;getContract()</pre>
<div class="block">Gets the contract which was used to initialize this channel</div>
</li>
</ul>
<a id="checkNotExpired()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkNotExpired</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;checkNotExpired()</pre>
<div class="block">Checks if the channel is expired, setting state to <a href="PaymentChannelClientState.State.html#EXPIRED"><code>PaymentChannelClientState.State.EXPIRED</code></a>, removing this channel from wallet
 storage and throwing an <code>IllegalStateException</code> if it is.</div>
</li>
</ul>
<a id="incrementPaymentBy(org.bitcoinj.core.Coin,org.bouncycastle.crypto.params.KeyParameter)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>incrementPaymentBy</h4>
<pre class="methodSignature">public&nbsp;<a href="PaymentChannelClientState.IncrementedPayment.html" title="class in org.bitcoinj.protocols.channels">PaymentChannelClientState.IncrementedPayment</a>&nbsp;incrementPaymentBy&#8203;(<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;size,
                                                                       @Nullable
                                                                       org.bouncycastle.crypto.params.KeyParameter&nbsp;userKey)
                                                                throws <a href="ValueOutOfRangeException.html" title="class in org.bitcoinj.protocols.channels">ValueOutOfRangeException</a></pre>
<div class="block"><p>Updates the outputs on the payment contract transaction and re-signs it. The state must be READY in order to
 call this method. The signature that is returned should be sent to the server so it has the ability to broadcast
 the best seen payment when the channel closes or times out.</p>

 <p>The returned signature is over the payment transaction, which we never have a valid copy of and thus there
 is no accessor for it on this object.</p>

 <p>To spend the whole channel increment by <a href="PaymentChannelV1ClientState.html#getTotalValue()"><code>PaymentChannelV1ClientState.getTotalValue()</code></a> -
 <a href="#getValueRefunded()"><code>getValueRefunded()</code></a></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>size</code> - How many satoshis to increment the payment by (note: not the new total).</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="ValueOutOfRangeException.html" title="class in org.bitcoinj.protocols.channels">ValueOutOfRangeException</a></code> - If size is negative or the channel does not have sufficient money in it to
                                  complete this payment.</dd>
</dl>
</li>
</ul>
<a id="updateChannelInWallet()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateChannelInWallet</h4>
<pre class="methodSignature">protected&nbsp;void&nbsp;updateChannelInWallet()</pre>
</li>
</ul>
<a id="disconnectFromChannel()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>disconnectFromChannel</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;disconnectFromChannel()</pre>
<div class="block">Sets this channel's state in <a href="StoredPaymentChannelClientStates.html" title="class in org.bitcoinj.protocols.channels"><code>StoredPaymentChannelClientStates</code></a> to unopened so this channel can be reopened
 later.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#storeChannelInWallet(org.bitcoinj.core.Sha256Hash)"><code>storeChannelInWallet(Sha256Hash)</code></a></dd>
</dl>
</li>
</ul>
<a id="storeChannelInWallet(org.bitcoinj.core.Sha256Hash)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storeChannelInWallet</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;storeChannelInWallet&#8203;(<a href="../../core/Sha256Hash.html" title="class in org.bitcoinj.core">Sha256Hash</a>&nbsp;id)</pre>
<div class="block"><p>Stores this channel's state in the wallet as a part of a <a href="StoredPaymentChannelClientStates.html" title="class in org.bitcoinj.protocols.channels"><code>StoredPaymentChannelClientStates</code></a> wallet
 extension and keeps it up-to-date each time payment is incremented. This allows the
 <a href="StoredPaymentChannelClientStates.html" title="class in org.bitcoinj.protocols.channels"><code>StoredPaymentChannelClientStates</code></a> object to keep track of timeouts and broadcast the refund transaction
 when the channel expires.</p>

 <p>A channel may only be stored after it has fully opened (ie state == State.READY). The wallet provided in the
 constructor must already have a <a href="StoredPaymentChannelClientStates.html" title="class in org.bitcoinj.protocols.channels"><code>StoredPaymentChannelClientStates</code></a> object in its extensions set.</p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>id</code> - A hash providing this channel with an id which uniquely identifies this server. It does not have to be
           unique.</dd>
</dl>
</li>
</ul>
<a id="getRefundTxFees()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRefundTxFees</h4>
<pre class="methodSignature">public abstract&nbsp;<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;getRefundTxFees()</pre>
<div class="block">Returns the fees that will be paid if the refund transaction has to be claimed because the server failed to settle
 the channel properly. May only be called after <a href="#initiate(org.bouncycastle.crypto.params.KeyParameter,org.bitcoinj.protocols.channels.IPaymentChannelClient.ClientChannelProperties)"><code>initiate(KeyParameter, IPaymentChannelClient.ClientChannelProperties)</code></a></div>
</li>
</ul>
<a id="getTotalValue()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTotalValue</h4>
<pre class="methodSignature">public abstract&nbsp;<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;getTotalValue()</pre>
<div class="block">Gets the total value of this channel (ie the maximum payment possible)</div>
</li>
</ul>
<a id="getValueRefunded()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValueRefunded</h4>
<pre class="methodSignature">public&nbsp;<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;getValueRefunded()</pre>
<div class="block">Gets the current amount refunded to us from the multisig contract (ie totalValue-valueSentToServer)</div>
</li>
</ul>
<a id="getValueSpent()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValueSpent</h4>
<pre class="methodSignature">public&nbsp;<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;getValueSpent()</pre>
<div class="block">Returns the amount of money sent on this channel so far.</div>
</li>
</ul>
<a id="getValueToMe()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValueToMe</h4>
<pre class="methodSignature">protected abstract&nbsp;<a href="../../core/Coin.html" title="class in org.bitcoinj.core">Coin</a>&nbsp;getValueToMe()</pre>
</li>
</ul>
<a id="getExpiryTime()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getExpiryTime</h4>
<pre class="methodSignature">protected abstract&nbsp;long&nbsp;getExpiryTime()</pre>
</li>
</ul>
<a id="getContractInternal()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContractInternal</h4>
<pre class="methodSignature">protected abstract&nbsp;<a href="../../core/Transaction.html" title="class in org.bitcoinj.core">Transaction</a>&nbsp;getContractInternal()</pre>
<div class="block">Gets the contract without changing the state machine</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the contract.</dd>
</dl>
</li>
</ul>
<a id="getContractScript()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContractScript</h4>
<pre class="methodSignature">protected abstract&nbsp;<a href="../../script/Script.html" title="class in org.bitcoinj.script">Script</a>&nbsp;getContractScript()</pre>
</li>
</ul>
<a id="getSignedScript()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getSignedScript</h4>
<pre class="methodSignature">protected abstract&nbsp;<a href="../../script/Script.html" title="class in org.bitcoinj.script">Script</a>&nbsp;getSignedScript()</pre>
<div class="block">Gets the script that is signed. In the case of a P2SH contract this is the
 script inside the P2SH script.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the signed script.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
